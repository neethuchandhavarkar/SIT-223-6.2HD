pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                script {
                    env.PYTHON_HOME = '/path/to/python3.12' // Replace with your Python installation path
                    sh '${PYTHON_HOME}/python -m pip install -r requirements.txt'
                    sh '${PYTHON_HOME}/python setup.py sdist'
                }
                archiveArtifacts artifacts: 'dist/*.tar.gz', allowEmptyArchive: true
            }
        }
        stage('Test') {
            steps {
                sh '${PYTHON_HOME}/python -m pytest'
                junit 'junit.xml'
            }
        }
        stage('Code Quality Analysis') {
            steps {
                sh '${PYTHON_HOME}/python -m pylint src'
                sh '${PYTHON_HOME}/python -m flake8 src'
            }
        }
    }
}
