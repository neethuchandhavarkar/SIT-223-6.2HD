pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo "Installing dependencies from requirements.txt"
                sh 'pip install -r requirements.txt'  // Install Python dependencies
                echo "Building the source distribution"
                sh 'python setup.py sdist'  // Build the source distribution
                echo "Archiving built artifacts"
                archiveArtifacts artifacts: 'dist/*.tar.gz', fingerprint: true  // Archive the built artifacts
            }
        }
        stage('Test') {
            steps {
                echo "Running tests with pytest"
                sh 'pytest'  // Execute the tests
                echo "Publishing test results"
                junit 'junit.xml'  // Publish test results in JUnit format
            }
        }
        stage('Code Quality Analysis') {
            steps {
                echo "Performing code quality analysis with pylint"
                sh 'pylint src'  // Run pylint for code quality
                echo "Running flake8 for style guide enforcement"
                sh 'flake8 src'  // Run flake8 for style guide enforcement
            }
        }
    }

    post {
        always {
            echo "Pipeline execution completed"
        }
    }
}
